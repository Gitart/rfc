# Формат приемо-передачи данных для PharmXplorer (Draft) #

*документ постоянно обновляется*

Искомый формат предполагает возможность передачи данных о приходах/расходах/остатках из одной или нескольких точек за определенный временной интервал. Формат обеспечивает требования текущей архитектуры обработки данных (legacy). Пары ключ-значение, для которых не существует значения (0 для чисел или пустые строки) могут быть исключены при формировании реальных выходных данных.

Спецификация-пример (1 точка, 1 наименование):

* Формат [JSON](http://json.org/json-ru.html)
* Кодировка [UTF-8](http://ru.wikipedia.org/wiki/UTF-8)
* `/* */` - это комментарий только для пояснения и он должен отсутствовать в реальных данных
* `[*]` - эту пару ключ-значение можно пропустить 
* `string, int, float` - типы данных: “строка в двойных кавычках”, целое, число с плавающей точкой (разделитель точка “.”)

```json
{
	/* Метаданные */
	"Meta": {
		/* Версия формата, int */
		"Version": 1,
		/* Отправитель (public key), string */
		"Sender": "f96b5d3726906aeb99fb6b2bc37f91a519cbc767",
		/* Агент передачи данных (программа) [*], string */
		"Agent": "My Cool Application",
		/* Проект, для которого формируются данные, string[sale-in|sale-out] */
		"Project": "sale-out/dayly",
		/* Учетность данных, string[analytical|synthetic] */
		"Accounting": "analytical",
		/* Нижняя граница временного диапазона отбора данных, string[dd.mm.yyyy hh:mm:ss] */
		"TimeRangeLower": "08.10.2012 00:00:00",
		/* Верхняя граница временного диапазона отбора данных, string[dd.mm.yyyy hh:mm:ss] */
		"TimeRangeUpper": "08.10.2012 23:59:59"		
	},
	/* Данные (массив заголовок/содержание) */
	"Data": [{
		/* Заголовок */
		"Head": {
			/* Источник данных (BR_NICK), string[20] */
			"Source": "21-00-0540-А",
		},
		/* Содержание (массив записей содержания) */
		"Item": [{
			/* Code: Код препарата клиента, string[40] */
			"C": "10420",
			/* Name: Полное наименование препарата + производитель (через пробел), string[255] */
			"N": "Авамис аэр.27,5мкг/доза бал. 30д Глаксо Велком",
			/* SupplierName: Поставщик [*]-только для sale-in, string[1024] */
			"SN": "Рога и Копыта Корпорейшн",
			/* SupplierEGRPOU: ЕГРПОУ (ранее ОКПО) [*]-только для sale-in, string[12] */
			"SE": "82389009",
			/* LinkName: Связь Морион для наименования [*]-вносится сервисом распознавания */
			"LN": "FIXME",
			/* LinkSupplier: Связь Морион для поставщика [*]-вносится сервисом распознавания */
			"LS": "FIXME",
			/* InputQuantity: Приход количество, float */
			"IQ": 20,
			/* InputPrice: Приход цена (за единицу товара, float */
			"IP": 32.50,
			/* OutputQuantity: Расход количество, float */
			"OQ": 3,
			/* OutputPrice: Расход цена (за единицу товара), float */
			"OP": 39.72,
			/* BalanceQuantity: Остаток на конец периода, float */
			"BQ": 8
		}]
	}]
}
```
